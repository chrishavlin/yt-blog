<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><title>3D Surfaces and Sketchfab | yt project blog</title><meta name=author content="Matthew Turk"><meta name=description content="Let&amp;rsquo;s talk about exporting surfaces to sketchfab with yt!"><meta name=generator content="Hugo 0.71.1"><link rel=canonical href=https://munkm.github.io/yt-blog/posts/sketchfab/><meta property="og:title" content="3D Surfaces and Sketchfab"><meta property="og:description" content="Let&rsquo;s talk about exporting surfaces to sketchfab with yt!"><meta property="og:type" content="article"><meta property="og:url" content="https://munkm.github.io/yt-blog/posts/sketchfab/"><meta property="article:published_time" content="2012-12-05T13:37:36-06:00"><meta property="article:modified_time" content="2020-12-04T13:37:36-06:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="3D Surfaces and Sketchfab"><meta name=twitter:description content="Let&rsquo;s talk about exporting surfaces to sketchfab with yt!"><link rel=stylesheet href=https://munkm.github.io/yt-blog/css/semantic.min.css><link rel=stylesheet href=https://munkm.github.io/yt-blog/css/icomoon.css><link rel=stylesheet href=https://munkm.github.io/yt-blog/css/OverlayScrollbars.min.css><link rel=stylesheet href=https://munkm.github.io/yt-blog/css/github-markdown.css><link rel=stylesheet href=https://munkm.github.io/yt-blog/css/site.css><style>a:hover{text-decoration:underline}</style></head><body class=default><nav class="ui secondary menu dream-menu"><div class=item><i class="large link bullseye icon dream-flip-toggle" title="Flip it!"></i></div><div class=item><i class="large link home icon" title=Home onclick="window.location.href='https:\/\/munkm.github.io\/yt-blog\/'"></i></div><div class=item><i class="large link icon theme-switch" onclick=themeSwitch()></i></div></nav><div class=flip-container><div class=flipper><section class=front><div class=dream-max-width><div class="ui centered relaxed grid dream-grid"><div class="sixteen wide mobile sixteen wide tablet twelve wide computer column markdown-body dream-single" id=dream-save-post-as-img><section class="ui top attached segment"><header><h1 class="ui large header">3D Surfaces and Sketchfab<div class="sub header">@
<a href=https://matthewturk.github.io/ target=_blank>Matthew Turk</a>
|
Wednesday, Dec 5, 2012
| 5 minute read
| Update at
Friday, Dec 4, 2020</div></h1></header><article class=main><p>Let&rsquo;s talk about exporting surfaces to sketchfab with yt!</p><h1 id=3d-surfaces-and-sketchfab>3D Surfaces and Sketchfab</h1><h2 id=surfaces>Surfaces</h2><p>For a while now, yt has had the ability to extract isosurfaces from volumetric
data using a <a href=http://en.wikipedia.org/wiki/Marching_cubes>marching cubes</a>
algorithm. The surfaces could be exported in
<a href=http://en.wikipedia.org/wiki/Wavefront_.obj_file>OBJ format</a>,
values could be samples
at the center of each face of the surface, and flux of a given field could be
calculated over the surface. This means you could, for instance, extract an
isocontour in density and calculate the mass flux over that isocontour. It
also means you could export a surface from yt and view it in something like
<a href=http://www.blender.org/>Blender</a>, <a href=http://meshlab.sourceforge.net/>MeshLab</a>,
or even on your Android or iOS device in
<a href=http://www.meshpad.org/>MeshPad</a> or
<a href="https://play.google.com/store/apps/details?id=it.isticnr.meshlab&hl=en">MeshLab Android</a>.
One important caveat with marching cubes is that with adaptive mesh refinement
data, you <em>will</em> see cracks across refinement boundaries unless a
&ldquo;crack-fixing&rdquo; step is applied to match up these boundaries. yt does not
perform such an operation, and so there will be seams visible in 3D views of
your isosurfaces.</p><p>The methods to do so were methods on data objects &ndash; <code>extract_isocontours</code>,
<code>calculate_isocontour_flux</code> &ndash; which returned just numbers or values.
However, recently, I&rsquo;ve created a new object called <code>AMRSurface</code> that makes
this process much easier. You can create one of these objects by specifying a
source data object and a field over which to identify a surface at a given
value. For example:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Python data-lang=Python>   <span style=color:#f92672>from</span> yt.mods <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
   pf <span style=color:#f92672>=</span> load(<span style=color:#e6db74>&#34;/data/workshop2012/IsolatedGalaxy/galaxy0030/galaxy0030&#34;</span>)
   sphere <span style=color:#f92672>=</span> pf<span style=color:#f92672>.</span>h<span style=color:#f92672>.</span>sphere(<span style=color:#e6db74>&#34;max&#34;</span>, (<span style=color:#ae81ff>1.0</span>, <span style=color:#e6db74>&#34;mpc&#34;</span>))
   surface <span style=color:#f92672>=</span> pf<span style=color:#f92672>.</span>h<span style=color:#f92672>.</span>surface(sphere, <span style=color:#e6db74>&#34;Density&#34;</span>, <span style=color:#ae81ff>1e-27</span>)
</code></pre></div><p>This object, <code>surface</code>, can now be queried for values on the surface. For
instance:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Python data-lang=Python>
   <span style=color:#66d9ef>print</span> surface[<span style=color:#e6db74>&#34;Temperature&#34;</span>]<span style=color:#f92672>.</span>min(), surface[<span style=color:#e6db74>&#34;Temperature&#34;</span>]<span style=color:#f92672>.</span>max()

</code></pre></div><p>will return the values 11850.7476943 and 13641.0663899. These values are
interpolated to the face centers of every triangle that constitutes a portion
of the surface. Note that reading a new field requires re-calculating the
entire surface, so it&rsquo;s not the fastest operation. You can get the vertices of
the triangle by looking at the property <code>.vertices</code>.</p><h2 id=exporting-to-a-file>Exporting to a File</h2><p>If you want to export this to a i
<a href=http://en.wikipedia.org/wiki/PLY_(file_format)>PLY file</a> you can call the routine
<code>export_ply</code>, which will write to a file and optionally sample a field at
every face or vertex, outputting a color value to the file as well. This file
can then be viewed in MeshLab, Blender or on the website
<a href=Sketchfab.com>Sketchfab.com</a> But if you want to view it on Sketchfab, there&rsquo;s an even
easier way!</p><h2 id=exporting-to-sketchfab>Exporting to Sketchfab</h2><p><a href=http://sketchfab.com>Sketchfab</a> is a website that uses WebGL, a relatively
new technology for displaying 3D graphics in any browser. It&rsquo;s very fast and
typically requires no plugins. Plus, it means that you can share data with
anyone and they can view it immersively without having to download the data or
any software packages! Sketchfab provides a free tier for up to 10 models, and
these models can be embedded in websites.</p><p>There are lots of reasons to want to export to Sketchfab. For instance, if
you&rsquo;re looking at a galaxy formation simulation and you publish a paper, you
can include a link to the model in that paper (or in the arXiv listing) so that
people can explore and see what the data looks like. You can also embed a
model in a website with other supplemental data, or you can use Sketchfab to
discuss morphological properties of a dataset with collaborators. It&rsquo;s also
just plain cool.</p><p>The <code>AMRSurface</code> object includes a method to upload directly to Sketchfab,
but it requires that you get an API key first. You can get this API key by
creating an account and then going to your &ldquo;dashboard,&rdquo; where it will be listed
on the right hand side. Once you&rsquo;ve obtained it, put it into your
<code>~/.yt/config</code> file under the heading <code>[yt]</code> as the variable
<code>sketchfab_api_key</code>. If you don&rsquo;t want to do this, you can also supply it as
an argument to the function <code>export_sketchfab</code>.</p><p>Now you can run a script like this:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Python data-lang=Python>   <span style=color:#f92672>from</span> yt.mods <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
   pf <span style=color:#f92672>=</span> load(<span style=color:#e6db74>&#34;redshift0058&#34;</span>)
   dd <span style=color:#f92672>=</span> pf<span style=color:#f92672>.</span>h<span style=color:#f92672>.</span>sphere(<span style=color:#e6db74>&#34;max&#34;</span>, (<span style=color:#ae81ff>200</span>, <span style=color:#e6db74>&#34;kpc&#34;</span>))
   rho <span style=color:#f92672>=</span> <span style=color:#ae81ff>5e-27</span>

   bounds <span style=color:#f92672>=</span> [(dd<span style=color:#f92672>.</span>center[i] <span style=color:#f92672>-</span> <span style=color:#ae81ff>100.0</span><span style=color:#f92672>/</span>pf[<span style=color:#e6db74>&#39;kpc&#39;</span>],
              dd<span style=color:#f92672>.</span>center[i] <span style=color:#f92672>+</span> <span style=color:#ae81ff>100.0</span><span style=color:#f92672>/</span>pf[<span style=color:#e6db74>&#39;kpc&#39;</span>]) <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>3</span>)]

   surf <span style=color:#f92672>=</span> pf<span style=color:#f92672>.</span>h<span style=color:#f92672>.</span>surface(dd, <span style=color:#e6db74>&#34;Density&#34;</span>, rho)

   upload_id <span style=color:#f92672>=</span> surf<span style=color:#f92672>.</span>export_sketchfab(
       title <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;RD0058 - 5e-27&#34;</span>,
       description <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Extraction of Density (colored by Temperature) at 5e-27 &#34;</span> \
                   <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;g/cc from a galaxy formation simulation by Ryan Joung.&#34;</span>
       color_field <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Temperature&#34;</span>,
       color_map <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;hot&#34;</span>,
       color_log <span style=color:#f92672>=</span> True,
       bounds <span style=color:#f92672>=</span> bounds
   )
</code></pre></div><p>and yt will extract a surface, convert to a format that Sketchfab.com
understands (PLY, in a zip file) and then upload it using your API key. For
this demo, I&rsquo;ve used data kindly provided by Ryan Joung from a simulation of
galaxy formation. Here&rsquo;s what my newly-uploaded model looks like, using the
embed code from Sketchfab:</p><p>As a note, Sketchfab has a maximum model size of 50MB for the free account.
50MB is pretty hefty, though, so it shouldn&rsquo;t be a problem for most needs.
We&rsquo;re working on a way to optionally upload links to the Sketchfab models on
the <a href=https://hub.yt-project.org/>yt Hub</a>, but for now, if you want to share
a cool model we&rsquo;d love to see it!</p><p>Thanks to Sketchfab for such a cool service, and for helping us out along the
way with their API.
The remaining content of your post.</p></article></section><footer class="ui attached segment dream-tags" data-html2canvas-ignore><a class="ui label" href=https://munkm.github.io/yt-blog/tags/features title=features>features</a>
<a class="ui label" href=https://munkm.github.io/yt-blog/tags/surfaces title=surfaces>surfaces</a><div class="ui label" style=float:right;cursor:pointer onclick=savePostAsImg()><i class="save icon"></i>Save as image</div></footer></div><aside class="sixteen wide mobile sixteen wide tablet four wide computer column dream-single-aside"><div class="ui segment toc"><nav id=TableOfContents><ul><li><a href=#surfaces>Surfaces</a></li><li><a href=#exporting-to-a-file>Exporting to a File</a></li><li><a href=#exporting-to-sketchfab>Exporting to Sketchfab</a></li></ul></nav></div><article class=dream-header><section class="ui top attached center aligned segment"><div class="ui small circular image"><img src=https://munkm.github.io/yt-blog/img/yt_logo.svg></div><div class="ui medium header">the yt project's blog<div class="sub header" style=margin-top:.5rem></div></div><div class="ui horizontal list"><a class=item href=https://munkm.github.io/yt-blog/posts><i class="archive icon" title=Archives></i></a><a class=item href=https://munkm.github.io/yt-blog/tags><i class="tags icon" title="All Tags"></i></a><a class=item href=https://munkm.github.io/yt-blog/categories><i class="th list icon" title="All Categories"></i></a></div></section><section class="ui attached center aligned segment dream-tags"><a class="ui label" href=https://munkm.github.io/yt-blog/tags/annotations/ title=Annotations>Annotations</a>
<a class="ui label" href=https://munkm.github.io/yt-blog/tags/community/ title=Community>Community</a>
<a class="ui label" href=https://munkm.github.io/yt-blog/tags/features/ title=Features>Features</a>
<a class="ui label" href=https://munkm.github.io/yt-blog/tags/new-feature/ title="New Feature">New Feature</a>
<a class="ui label" href=https://munkm.github.io/yt-blog/tags/particles/ title=Particles>Particles</a>
<a class="ui label" href=https://munkm.github.io/yt-blog/tags/releases/ title=Releases>Releases</a>
<a class="ui label" href=https://munkm.github.io/yt-blog/tags/sliceplot/ title=Sliceplot>Sliceplot</a>
<a class="ui label" href=https://munkm.github.io/yt-blog/tags/surfaces/ title=Surfaces>Surfaces</a>
<a class="ui label" href=https://munkm.github.io/yt-blog/tags/tutorial/ title=Tutorial>Tutorial</a></section><section class="ui attached segment dream-categories"><div class="ui accordion"><div class=title><i class="dropdown icon"></i><a class=item href=https://munkm.github.io/yt-blog/categories/development/ title=Development>Development</a></div><div class=content><div class="ui list"><div class=item><div class=content><a class=item href=https://munkm.github.io/yt-blog/posts/governance/>Much Ado About Governance</a></div></div><div class=item><div class=content><a class=item href=https://munkm.github.io/yt-blog/posts/relicensing/>Relicensing yt from GPLv3 to BSD</a></div></div><div class=item><div class=content><a class=item href=https://munkm.github.io/yt-blog/posts/devworkshop2013/>The first yt development workshop!</a></div></div><div class=item><div class=content><a class=item href=https://munkm.github.io/yt-blog/posts/yt-25/>yt 2.5 released!</a></div></div><div class=item><div class=content><a class=item href=https://munkm.github.io/yt-blog/posts/devworkshopannounce2013/>Announcing the 2013 yt development workshop</a></div></div><div class=item><div class=content><a class=item href=https://munkm.github.io/yt-blog/posts/2012-review/>2012 In Review</a></div></div></div></div><div class=title><i class="dropdown icon"></i><a class=item href=https://munkm.github.io/yt-blog/categories/tutorial/ title=Tutorial>Tutorial</a></div><div class=content><div class="ui list"><div class=item><div class=content><a class=item href=https://munkm.github.io/yt-blog/posts/line-integral/>Line Integral Convolution for Vector Field Visualization</a></div></div><div class=item><div class=content><a class=item href=https://munkm.github.io/yt-blog/posts/objexporter/>Obj File Exporter for Surfaces</a></div></div><div class=item><div class=content><a class=item href=https://munkm.github.io/yt-blog/posts/particle-gen/>Particle Generators</a></div></div><div class=item><div class=content><a class=item href=https://munkm.github.io/yt-blog/posts/sketchfab/>3D Surfaces and Sketchfab</a></div></div></div></div></div></section><section class="ui attached segment header-socials"><nav class="ui secondary menu dream-menu dream-socials"></nav></section><section class="ui bottom attached center aligned segment"><p>© 2020 yt project blog</p><p>Powered by <a href=https://gohugo.io/ target=_blank>Hugo</a> with theme <a href=https://github.com/g1eny0ung/hugo-theme-dream target=_blank>Dream</a>.</p></section></article></aside></div></div></section><section class=back><div class=dream-max-width><div class="ui centered relaxed grid dream-grid dream-back"><section class="sixteen wide mobile eight wide tablet four wide computer column dream-column"><article><div class="ui top attached segment"><h3 class="ui header">Social Links</h3></div><div class="ui bottom attached segment"><nav class="ui secondary menu dream-menu dream-socials"></nav></div></article></section><section class="sixteen wide mobile eight wide tablet four wide computer column dream-column"></section></div></div></section></div></div><script>window.backgroundDark=null
window.backgroundImageDark=null
window.darkNav=null
window.hasTwitterEmbed=null
if(window.hasTwitterEmbed){window.twttr=(function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],t=window.twttr||{}
if(d.getElementById(id))return t
js=d.createElement(s)
js.id=id
js.src='https://platform.twitter.com/widgets.js'
fjs.parentNode.insertBefore(js,fjs)
t._e=[]
t.ready=function(f){t._e.push(f)}
return t})(document,'script','twitter-wjs')}</script><script src=https://munkm.github.io/yt-blog/js/jquery.min.js></script><script src=https://munkm.github.io/yt-blog/js/semantic.min.js></script><script src=https://munkm.github.io/yt-blog/js/jquery.overlayScrollbars.min.js></script><script src=https://munkm.github.io/yt-blog/js/header.js></script><script src=https://munkm.github.io/yt-blog/js/main.js></script><script src=https://munkm.github.io/yt-blog/js/theme.js></script><script src=https://munkm.github.io/yt-blog/js/html2canvas.min.js></script><script src=https://munkm.github.io/yt-blog/js/post.js></script></body></html>